<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§—Ä—É–∫—Ç–æ–≤—ã–π —Å–ª–æ—Ç v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #1a1a2e; /* –¢–µ–º–Ω–æ-—Å–∏–Ω–∏–π —Ñ–æ–Ω */
            font-family: 'Inter', sans-serif;
            color: #e0e0e0; /* –°–≤–µ—Ç–ª—ã–π —Ç–µ–∫—Å—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }
        .slot-reel {
            background-color: #2c2c54;
            border: 2px solid #40407a;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease-out;
            width: 80px; /* –®–∏—Ä–∏–Ω–∞ –±–∞—Ä–∞–±–∞–Ω–∞ */
            height: 100px; /* –í—ã—Å–æ—Ç–∞ –±–∞—Ä–∞–±–∞–Ω–∞ */
        }
        .slot-symbol {
            font-size: 3.5rem; /* –†–∞–∑–º–µ—Ä —Å–∏–º–≤–æ–ª–æ–≤ */
            line-height: 1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        .play-button {
            background: linear-gradient(180deg, #ff6b6b 0%, #ee5253 100%);
            transition: background 0.3s ease, transform 0.1s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        .play-button:hover {
            background: linear-gradient(180deg, #ee5253 0%, #ff6b6b 100%);
        }
        .play-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2);
        }
        .play-button:disabled {
            background: #777; /* –¢–µ–º–Ω–µ–µ —Å–µ—Ä—ã–π –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ */
            cursor: not-allowed;
            opacity: 0.6;
            box-shadow: none;
        }
        /* –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è */
        @keyframes spin {
            0% { transform: translateY(-15px); opacity: 0.5; }
            50% { transform: translateY(15px); opacity: 0.5; }
            100% { transform: translateY(0); opacity: 1; }
        }
        .spinning {
            animation: spin 0.2s linear 3;
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–∑–æ–≤ */
        .prize-list-item {
            display: flex;
            align-items: center;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }
        .prize-icon {
            margin-right: 8px;
            font-size: 1.1rem; /* –†–∞–∑–º–µ—Ä –∏–∫–æ–Ω–æ–∫ –≤ —Å–ø–∏—Å–∫–µ */
            width: 4.5em; /* –ù–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ */
            display: inline-block;
            text-align: center;
            white-space: nowrap; /* –î–æ–±–∞–≤–ª–µ–Ω–æ: –ó–∞–ø—Ä–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å–∏–º–≤–æ–ª–æ–≤ */
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="main-container bg-gray-800 p-6 md:p-8 rounded-lg shadow-xl text-center max-w-md w-full">

        <div id="spin-counter" class="text-xl font-bold text-yellow-400 mb-4">–°–ø–∏–Ω ‚Ññ1 | –û—Å—Ç–∞–ª–æ—Å—å: 10</div>

        <div class="flex justify-center space-x-3 md:space-x-4 mb-6">
            <div id="slot1" class="slot-reel rounded-md flex items-center justify-center">
                <span class="slot-symbol">‚ùì</span>
            </div>
            <div id="slot2" class="slot-reel rounded-md flex items-center justify-center">
                <span class="slot-symbol">‚ùì</span>
            </div>
            <div id="slot3" class="slot-reel rounded-md flex items-center justify-center">
                <span class="slot-symbol">‚ùì</span>
            </div>
        </div>

        <p id="message" class="text-gray-300 mb-4 min-h-[2rem]">–£ –≤–∞—Å –µ—Å—Ç—å 10 —Å–ø–∏–Ω–æ–≤. –ù–∞–∂–º–∏—Ç–µ ¬´–ò–≥—Ä–∞—Ç—å¬ª!</p>

        <button id="play-button" class="play-button text-white font-bold py-3 px-8 rounded-lg text-xl w-full mb-6">
            –ò–ì–†–ê–¢–¨
        </button>

        <div id="prize-list" class="text-left text-sm text-gray-400 border-t border-gray-700 pt-4">
             <div class="prize-list-item">
                <span class="prize-icon">üéÅüéÅüéÅ</span> - +5 —Å–ø–∏–Ω–æ–≤
             </div>
             <div class="prize-list-item">
                <span class="prize-icon">üçíüçíüçí</span> - –ë–æ–Ω—É—Å–∫–∞ –Ω–∞ 80.000‚ÇΩ
             </div>
             <div class="prize-list-item">
                <span class="prize-icon">üçâüçâüçâ</span> - –í–∞—É—á–µ—Ä –Ω–∞ 33.333‚ÇΩ
             </div>
              <div class="prize-list-item">
                <span class="prize-icon">üîîüîîüîî</span> - –ß–µ–∫ –Ω–∞ 0.01 BTC ($849)
             </div>
             <div class="prize-list-item">
                <span class="prize-icon">üçìüçìüçì</span> - 500 FS
             </div>
        </div>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const spinCounterText = document.getElementById('spin-counter');
        const playButton = document.getElementById('play-button');
        const message = document.getElementById('message');
        const slots = [
            document.getElementById('slot1').querySelector('.slot-symbol'),
            document.getElementById('slot2').querySelector('.slot-symbol'),
            document.getElementById('slot3').querySelector('.slot-symbol')
        ];
        const slotReels = [
            document.getElementById('slot1'),
            document.getElementById('slot2'),
            document.getElementById('slot3')
        ];

        // –°–∏–º–≤–æ–ª—ã
        const symbols = ['üçí', 'üçä', 'üçã', 'üçâ', '‚≠ê', 'üîî', 'üéÅ', 'üçì'];
        const giftSymbol = 'üéÅ';
        const initialSpins = 10;
        const localStorageKeySpins = 'fruitSlotSpinsLeftV2'; // –ö–ª—é—á –¥–ª—è —Å–ø–∏–Ω–æ–≤
        const localStorageKeyBonus = 'fruitSlotBonusAwardedV2'; // –ö–ª—é—á –¥–ª—è —Ñ–ª–∞–≥–∞ –±–æ–Ω—É—Å–∞

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let spinsLeft;
        let totalSpinsMade;
        let isSpinning = false;
        let bonusSpinsAwarded = false; // –§–ª–∞–≥: –±—ã–ª –ª–∏ —É–∂–µ –≤—ã–¥–∞–Ω –±–æ–Ω—É—Å +5

        // --- –§—É–Ω–∫—Ü–∏–∏ ---

        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–≥—Ä—ã
        function initializeGame() {
            const savedSpins = localStorage.getItem(localStorageKeySpins);
            const savedBonusFlag = localStorage.getItem(localStorageKeyBonus);

            totalSpinsMade = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

            if (savedSpins !== null && !isNaN(parseInt(savedSpins))) {
                spinsLeft = parseInt(savedSpins, 10);
                bonusSpinsAwarded = (savedBonusFlag === 'true'); // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–ª–∞–≥

                // –ü–æ–ø—ã—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å totalSpinsMade (–≤—Å–µ –µ—â–µ –Ω–µ –∏–¥–µ–∞–ª—å–Ω–æ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)
                let potentialTotalSpins = initialSpins - spinsLeft;
                if (bonusSpinsAwarded && spinsLeft >= 5) { // –ï—Å–ª–∏ –±–æ–Ω—É—Å –±—ã–ª, –∏ —Å–ø–∏–Ω–æ–≤ > 5, —Ä–∞—Å—á–µ—Ç —Å–ª–æ–∂–Ω–µ–µ
                   // –û—Å—Ç–∞–≤–ª—è–µ–º –Ω–µ—Ç–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∏–ª–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É
                   // –ø–æ–∫–∞ –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–æ—Å—Ç–æ–π —Ä–∞—Å—á–µ—Ç
                   potentialTotalSpins = initialSpins + 5 - spinsLeft; // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å —É—á–µ—Ç–æ–º –±–æ–Ω—É—Å–∞
                }
                 if (potentialTotalSpins >= 0) {
                     totalSpinsMade = potentialTotalSpins;
                 }

            } else {
                // –°–≤–µ–∂–∏–π —Å—Ç–∞—Ä—Ç
                spinsLeft = initialSpins;
                totalSpinsMade = 0;
                bonusSpinsAwarded = false;
                localStorage.setItem(localStorageKeySpins, spinsLeft);
                localStorage.setItem(localStorageKeyBonus, bonusSpinsAwarded); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞
            }

            updateDisplays();

            if (spinsLeft <= 0) {
                endGame();
            } else {
                playButton.disabled = false;
            }
            slots.forEach(slot => slot.textContent = '‚ùì');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
        function updateDisplays() {
            spinCounterText.textContent = `–°–ø–∏–Ω ‚Ññ${totalSpinsMade + 1} | –û—Å—Ç–∞–ª–æ—Å—å: ${spinsLeft}`;
            if (spinsLeft > 0 && !isSpinning) {
                 message.textContent = `–£ –≤–∞—Å –µ—Å—Ç—å ${spinsLeft} —Å–ø–∏–Ω–æ–≤. –ù–∞–∂–º–∏—Ç–µ ¬´–ò–≥—Ä–∞—Ç—å¬ª!`;
            } else if (spinsLeft <= 0) {
                 // endGame() —É—Å—Ç–∞–Ω–æ–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
        function endGame() {
            message.textContent = '–£–≤—ã, —É–¥–∞—á–∞ –≤–∞–º –Ω–µ —É–ª—ã–±–Ω—É–ª–∞—Å—å, –Ω–æ –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –∏—Å–ø—ã—Ç–∞—Ç—å –µ–µ –Ω–∞ 1win!';
            playButton.disabled = true;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
        function getRandomSymbol(excludeGift = false) {
            let availableSymbols = symbols;
            if (excludeGift) {
                availableSymbols = symbols.filter(s => s !== giftSymbol);
            }
            if (availableSymbols.length === 0) return symbols[0];
            return availableSymbols[Math.floor(Math.random() * availableSymbols.length)];
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
        function spinReels(finalResult) {
            isSpinning = true;
            playButton.disabled = true;
            message.textContent = '–í—Ä–∞—â–∞–µ–º...';

            slotReels.forEach(reel => reel.classList.add('spinning'));

            let spinInterval = setInterval(() => {
                 slots.forEach((slot) => {
                     slot.textContent = getRandomSymbol(true);
                 });
            }, 50);

            setTimeout(() => {
                 clearInterval(spinInterval);
                 slotReels.forEach(reel => reel.classList.remove('spinning'));
                 showResult(finalResult);
                 isSpinning = false;
            }, 600);
        }

        // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å–ø–∏–Ω–∞
        function showResult(result) {
            slots.forEach((slot, index) => {
                slot.textContent = result[index];
            });

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à (—Ç—Ä–∏ –ø–æ–¥–∞—Ä–∫–∞) –∏ —á—Ç–æ –±–æ–Ω—É—Å –µ—â–µ –Ω–µ –±—ã–ª –≤—ã–¥–∞–Ω
            if (result.every(symbol => symbol === giftSymbol) && !bonusSpinsAwarded) {
                message.textContent = '+5 –ü—Ä–æ–∫—Ä—É—Ç–æ–≤!';
                spinsLeft += 5;
                bonusSpinsAwarded = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥
                localStorage.setItem(localStorageKeySpins, spinsLeft); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏–Ω—ã
                localStorage.setItem(localStorageKeyBonus, bonusSpinsAwarded); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–ª–∞–≥
                updateDisplays(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Å —É—á–µ—Ç–æ–º –±–æ–Ω—É—Å–∞
            } else {
                 if (spinsLeft > 0) {
                    // –ï—Å–ª–∏ –≤—ã–ø–∞–ª–∏ –ø–æ–¥–∞—Ä–∫–∏, –Ω–æ –±–æ–Ω—É—Å —É–∂–µ –±—ã–ª, –∏–ª–∏ –≤—ã–ø–∞–ª–æ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ
                    message.textContent = '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ!';
                 }
            }

            if (spinsLeft <= 0) {
                endGame();
            } else {
                playButton.disabled = false;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–ò–≥—Ä–∞—Ç—å"
        playButton.addEventListener('click', () => {
            if (isSpinning || spinsLeft <= 0) return;

            const spinsBeforeClick = spinsLeft;

            spinsLeft--;
            totalSpinsMade++;

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Å–ø–∏–Ω—ã –∑–¥–µ—Å—å, —Ñ–ª–∞–≥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–¥–∞—á–µ –±–æ–Ω—É—Å–∞
            localStorage.setItem(localStorageKeySpins, spinsLeft);
            updateDisplays();

            let result;
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏–µ –¥–ª—è –±–æ–Ω—É—Å–∞: –±—ã–ª–æ 4 —Å–ø–∏–Ω–∞, —Å—Ç–∞–ª–æ 3, –ò –±–æ–Ω—É—Å –µ—â–µ –Ω–µ –≤—ã–¥–∞–≤–∞–ª—Å—è
            if (spinsBeforeClick === 4 && spinsLeft === 3 && !bonusSpinsAwarded) {
                 result = [giftSymbol, giftSymbol, giftSymbol];
                 // –§–ª–∞–≥ bonusSpinsAwarded –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ showResult
            } else {
                 // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ò–°–ö–õ–Æ–ß–ê–Ø —Ç—Ä–∏ –ø–æ–¥–∞—Ä–∫–∞
                 do {
                    result = [getRandomSymbol(), getRandomSymbol(), getRandomSymbol()];
                 } while (result.every(symbol => symbol === giftSymbol));
            }

            spinReels(result);
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        initializeGame();

    </script>

</body>
</html>
